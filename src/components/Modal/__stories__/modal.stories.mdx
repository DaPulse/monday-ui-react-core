import Modal from "../Modal";
import { useStorybookModalHelper } from "./helpers";
import { useRef, useState } from "react";
import { ArgsTable, Story, Canvas, Meta } from "@storybook/addon-docs";
import { createStoryMetaSettings } from "../../../storybook/functions/create-component-story";
import "./Modal.stories.scss";
import Button from "../../Button/Button";
import { Flex, ModalContent, ModalFooter, ModalHeader, TextField } from "components";
import { StoryDescription } from "../../../storybook/components/story-description/story-description";

export const metaSettings = createStoryMetaSettings({
  component: Modal,
  enumPropNamesArray: [], // List enum props here
  iconPropNamesArray: [], // List props that are typed as icons here
  actionPropsArray: [] // List the component's actions here
});

<Meta title="Feedback/Modal" component={Modal} argTypes={metaSettings.argTypes} decorators={metaSettings.decorators} />

<!--- Component template -->

export const ModalTemplate = ({
  id = "sample-id",
  buttonTitle = "Open Modal",
  content = <p>Modal Content</p>,
  title = "Modal title",
  isAlertDialog = false,
  size = "medium",
  hideCloseButton = false
}) => {
  const [show, setShow] = useState(false);
  const buttonRef = useRef(null);
  const hideModal = () => setShow(false);
  return (
    <div>
      <Button ref={buttonRef} onClick={() => setShow(true)}>
        {buttonTitle}
      </Button>
      <Modal
        id={id}
        show={show}
        title={title}
        isAlertDialog={isAlertDialog}
        onClose={hideModal}
        size={size}
        triggerElement={buttonRef.current}
      >
        <ModalHeader title={title} hideCloseButton={hideCloseButton} />
        <ModalContent>{content}</ModalContent>
        <ModalFooter>
          <div className="monday-storybook-modal-new-buttons">
            <Button kind={Button.kinds.SECONDARY} onClick={hideModal}>
              Cancel
            </Button>
            <Button kind={Button.kinds.PRIMARY} onClick={hideModal}>
              Confirm
            </Button>
          </div>
        </ModalFooter>
      </Modal>
    </div>
  );
};

<!--- Component documentation -->

# Modal

- [Overview](#overview)
- [Props](#props)
- [Usage](#usage)
- [Variants](#variants)
- [Do’s and don’ts](#dos-and-donts)
- [Use cases and examples](#use-cases-and-examples)
- [Related components](#related-components)
- [Feedback](#feedback)

## Overview

An easy to use accessible Modal component

<Canvas>
  <Story name="Overview">
    {() => {
      const { openDialogButton, modalButtons, modalProps} = useStorybookModalHelper({title: 'Modal title', id: 'test-modal'});
      return (
        <div>
          {openDialogButton}
          <Modal
            {...modalProps}
          >
            <ModalContent>sadasdsadad</ModalContent>
            <ModalFooter>
              {modalButtons}
            </ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>

## Props

<ArgsTable of={Modal} />

## Usage

### Showing the Modal

You show/hide the Modal by passing the <b>show</b> prop. This gives you complete control on when to show and hide the Modal.
One thing to consider is when the user initiate closing the Modal by

### Modal content

### Design and customizations

<UsageGuidelines guidelines={["Usage guideline 1", "Usage guideline 2", "Usage guideline 3"]} />

<Tip title="Not what you were looking for?">Tip content</Tip>

## Variants

### Alert Modal (Modal)

This Modal will NOT be closed when you click outside or click ESC key. Only way to close it is to use the close button.

<UsageGuidelines guidelines={["set `isAlertDialog` to `true` in order to turn a Modal to modal."]} />

<Canvas>
  <Story
    name="Alert Modal"
    args={{
      title: "Modal title",
      buttonTitle: "open Modal",
      isAlertDialog: true,
      content: <p>Use the close button to dismiss this Modal.</p>
    }}
  >
    {ModalTemplate.bind({})}
  </Story>
</Canvas>

### Modal with a form

<UsageGuidelines
  guidelines={[
    "The Modal is capturing the focus. Use TAB ket to jump throw the close button and the inputs.",
    "Use Alert Modal so the user won't close the Modal by mistake and loose changes."
  ]}
/>

<Canvas>
  <Story
    name="Form Modal"
    args={{
      title: "Modal title",
      buttonTitle: "open From Modal",
      isAlertDialog: true,
      content: (
        <form>
          <TextField title="Your Name" autoFocus size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
        </form>
      )
    }}
  >
    {ModalTemplate.bind({})}
  </Story>
</Canvas>

### Size variants

<Canvas>
  <Story name="Size variants">
    <Flex direction={Flex.directions.ROW} gap={Flex.gaps.SMALL}>
      <StoryDescription description="S" vertical align={Flex.align.START}>
        <div className="monday-storybook-loader_size-variants_container">
          <ModalTemplate size={"small"} />
        </div>
      </StoryDescription>
      <StoryDescription description="M" vertical align={Flex.align.START}>
        <div className="monday-storybook-loader_size-variants_container">
          <ModalTemplate size={"medium"} />
        </div>
      </StoryDescription>
      <StoryDescription description="L" vertical align={Flex.align.START}>
        <div className="monday-storybook-loader_size-variants_container">
          <ModalTemplate size={"large"} />
        </div>
      </StoryDescription>
      <StoryDescription description="Full Width" vertical align={Flex.align.START}>
        <div className="monday-storybook-loader_size-variants_container">
          <ModalTemplate size={"full_width"} />
        </div>
      </StoryDescription>
    </Flex>
  </Story>
</Canvas>

## Use cases and examples

### Modal with vertical scroll

The height of Modal with long content will be limited to 90% of screen height, and a scroll bar will be added

<Canvas>
  <Story
    name="Modal with vertical scroll"
    args={{
      title: "Modal title",
      buttonTitle: "open long Modal",
      content: (
        <form>
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
          <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
        </form>
      )
    }}
  >
    {ModalTemplate.bind({})}
  </Story>
</Canvas>

## Related components

[//]: # "<RelatedComponents componentsNames={[]} />"
