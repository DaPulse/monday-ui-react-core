import Modal from "../Modal";
import { useModalHelper } from "./helpers";
import { ArgsTable, Story, Canvas, Meta } from "@storybook/addon-docs";
import { createStoryMetaSettings } from "../../../storybook";
import "./Modal.stories.scss";
import { Button, ModalContent, ModalFooter, ModalHeader, TextField } from "components";
import {
  TOOLTIP,
  ALERT_BANNER,
  Tipseen
} from "../../../storybook/components/related-components/component-description-map";
import { Settings } from "components/Icon/Icons";
import { RelatedComponents } from "../../../storybook"; import { useState } from "react";

export const metaSettings = createStoryMetaSettings({
  component: Modal,
  enumPropNamesArray: [], // List enum props here
  iconPropNamesArray: [], // List props that are typed as icons here
  actionPropsArray: [] // List the component's actions here
});

<Meta
  title="Feedback/Modal"
  component={Modal}
  subcomponents={{ ModalHeader, ModalContent, ModalFooter }}
  argTypes={metaSettings.argTypes}
  decorators={metaSettings.decorators}
/>

<!--- Component documentation -->

# Modal

- [Overview](#overview)
- [Props](#props)
- [Usage](#usage)
- [Variants](#variants)
- [Do’s and don’ts](#dos-and-donts)
- [Use cases and examples](#use-cases-and-examples)
- [Related components](#related-components)
- [Feedback](#feedback)

## Overview

An easy to use accessible Modal component

<Canvas>
  <Story name="Overview">
    {() => {
      const { openModalButton, modalButtons, show, closeModal, ref } = useModalHelper();
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            closeButtonAriaLabel={"close"}
          >
            <ModalContent>Modal content goes here</ModalContent>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>

## Props

<ArgsTable of={Modal} />

## Usage

### Design and customizations

<UsageGuidelines guidelines={["Usage guideline 1", "Usage guideline 2", "Usage guideline 3"]} />

<Tip title="Not what you were looking for?">Tip content</Tip>

## Variants

### Alert Modal (Modal)

This Modal will NOT be closed when you click outside or click ESC key. Only way to close it is to use the close button.

<UsageGuidelines guidelines={["set `isAlertDialog` to `true` in order to turn a Modal to modal."]} />

<Canvas>
  <Story name="Alert Modal">
    {() => {
      const { openModalButton, modalButtons, show, closeModal, ref } = useModalHelper();
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            isAlertDialog
            closeButtonAriaLabel={"close"}
          >
            <p>Use the close button to dismiss this Modal.</p>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>

### Width variants

<Canvas>
  <Story name="Width variants - Normal">
    {() => {
      const { openModalButton, modalButtons, show, closeModal, ref } = useModalHelper({
        openButtonTitle: "Default"
      });
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            closeButtonAriaLabel={"close"}
            width={Modal.Width.DEFAULT}
          >
            <p>Normal modal</p>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
  <Story name="Width variants - Full">
    {() => {
      const { openModalButton, modalButtons, show, closeModal, ref } = useModalHelper({
        openButtonTitle: "Full width"
      });
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            width={Modal.Width.FULL_WIDTH}
            closeButtonAriaLabel={"close"}
          >
            <p>Full width modal</p>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>

## Use cases and examples

### Showing the Modal

You show/hide the Modal by passing the <b>show</b> prop. This gives you complete control on when to show and hide the modal.

Keep in mind that when the user initiate closing the modal by clicking outside it or clicking the ESC key, you'll be responsible for closing the modal.
Pass a callback to the <b>onClose</b> function to know when it happens.
<Canvas>
  <Story name="Showing the Modal">
    {() => {
      const { modalButtons } = useModalHelper();
      const [show, setShow] = useState(false);
      const closeModal = () => {
        setShow(false);
      }
      return (
        <div>
          <Button onClick={() => setShow(true)}>Show</Button>
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            show={show}
            onClose={closeModal}
            closeButtonAriaLabel={"close"}
          >
            <ModalContent>Modal content goes here</ModalContent>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>


### Modal with footer buttons

As there are many possible combinations of buttons to display on the modal footer, we don't provide a build in support for footer buttons.
However, you can use the <b>ModalFooter</b> component to place any content at the bottom of the modal, including buttons.

<Canvas>
  <Story name="Modal with footer buttons">
    {() => {
      const { openModalButton, show, closeModal, ref } = useModalHelper({
        openButtonTitle: "Modal with buttons"
      });
      ;
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            closeButtonAriaLabel={"close"}
          >
            <ModalHeader title={"Modal Title"} description={"Modal description goes here"} icon={Settings} />
            <div>Modal content goes here</div>
            <ModalFooter className="monday-storybook-modal-new-buttons">
              <Button kind={Button.kinds.SECONDARY} onClick={closeModal}>Dismiss</Button>
              <Button onClick={closeModal}>Close</Button>
            </ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>


### Modal with custom Header

Use the <b>ModalHeader</b> component to render a Header with description and icon

<Canvas>
  <Story name="Modal with custom Header">
    {() => {
      const { openModalButton, modalButtons, show, closeModal, ref } = useModalHelper({
        openButtonTitle: "Custom Header"
      });
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            closeButtonAriaLabel={"close"}
          >
            <ModalHeader title={"Modal Title"} description={"Modal description goes here"} icon={Settings} />
            <div>Modal content goes here</div>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>

### Modal with a form

<UsageGuidelines
  guidelines={[
    "The Modal is capturing the focus. Use TAB ket to jump throw the close button and the inputs.",
    "Use Alert Modal so the user won't close the Modal by mistake and loose changes."
  ]}
/>

<Canvas>
  <Story name="Form Modal">
    {() => {
      const { openModalButton, modalButtons, show, closeModal, ref } = useModalHelper();
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            isAlertDialog
            closeButtonAriaLabel={"close"}
          >
            <ModalContent>
              <form>
                <TextField title="Your Name" autoFocus size={TextField.sizes.MEDIUM} placeholder="John Doe" />
                <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
                <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
                <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
                <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              </form>
            </ModalContent>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>

### Modal with vertical scroll

The height of Modal with long content will be limited to 90% of screen height, and a scroll bar will be added

<Canvas>
  <Story name="Modal with vertical scroll">
    {() => {
      const { openModalButton, modalButtons, show, closeModal, ref } = useModalHelper({
        openButtonTitle: "Vertical scroll"
      });
      return (
        <div>
          {openModalButton}
          <Modal
            id={"story-book-modal"}
            title={"Modal title"}
            triggerElement={ref.current}
            show={show}
            onClose={closeModal}
            closeButtonAriaLabel={"close"}
          >
            <form>
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Your Name" size={TextField.sizes.MEDIUM} placeholder="John Doe" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
              <TextField title="Email" size={TextField.sizes.MEDIUM} placeholder="email@monday.com" />
            </form>
            <ModalFooter>{modalButtons}</ModalFooter>
          </Modal>
        </div>
      );
    }}
  </Story>
</Canvas>

## Related components

<RelatedComponents componentsNames={[TOOLTIP, ALERT_BANNER, Tipseen]} />
